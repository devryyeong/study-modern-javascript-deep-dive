# 빌트인 객체

## 객체의 분류

- 표준 빌트인 객체
  - ECMAScript 사양에 정의된 객체
  - JS 실행 환경에 상관 없이 언제나 사용 가능
  - 전역 객체의 프로퍼티로 사용

- 호스트 객체
  - 자바스크립트 실행 환경에서 추가로 제공하는 객체
  - 브라우저 환경에서는 DOM, BOM, Canvas, XMLHttpRequest.. 등과 같은 클라이언트 사이드 Web API를 호스트 객체로 제공
  - Node.js 환경에서는 고유 API를 호스트 객체로 제공

- 사용자 정의 객체
  - 직접 정의한 객체

## 원시값과 래퍼 객체

- 원시값인 문자열, 숫자, 불리언 값의 경우 이들 원시값에 대해 마치 객체처럼 마침표 표기법(혹은 대괄호)로 접근하면, 자바스크립트 엔진이 일시적으로 원시값을 연관된 객체로 변환해 준다.

- 이를 래퍼 객체라 한다.

- 단, null, undefined과 같은 원시값은 레퍼 객체를 생성하지 않는다.

## 전역 객체

전역 객체는 코드가 실행되기 이전 단계에 엔진에 의해 먼저 생성되는 특수한 객체이며, 어떤 객체에도 속하지 않은 최상위 객체이다

> ECMAScript2020(ES11)에서 GlobalThis가 도입되었다
>
> 브라우저 환경과 Node.js 환경에서 전역 객체를 가리키던 다양한 식별자를 통일한 식별자다.

### 빌트인 전역 프로퍼티

- Infinity
- NaN
- undefined

### 빌트인 전역 함수

- eval
  - 자바스크립트 코드를 나타내는 문자열을 인수로 전달받는다.
  - 문자열 코드가 표현식이라면, 런타임에 평가하여 값을 생성한다.
  - 문이라면 무자열 코드를 런타임에 실행한다.
  - 여러개의 문이라면 모두 실행한다

- isFinite
  - 인수가 정상적인 유한수 인지 검사
  - 숫자가 아닌 경우, 타입 강제 변환
  - NaN인 경우 false

- isNaN
- parseFloat
  - 전달 받은 문자열 인수를 부동 소수점 숫자, 즉 실수로 해석하여  반환

- parseInt

- encodeURI / decodeURI
  - 완전한 URI를 무낮열로 전달받아, 이스케이프 처리를 위해 인코딩 / 디코딩 하는 것이다.
  - 인코딩이란 URI 문자들을 이스케이프 처리 하는 것을 의미한다.
  - 이스케이프 처리는 네트워크를 통해 정보를 공유할 때, 어떤 시스템에서도 읽을 수 있는 ASCII 문자 셋으로 변환하는 것을 의미한다.

- encodeURIComponent / decodeURIComponent
  - URI 구성 요소(component)를 인수로 전달 받아 인코딩 한다.
  - 알파벳, 0~9숫자, -, _, ., !, ~, (, ), 등은 제외
  - ?, =, & 까지 인코딩 및 디코딩 한다는 점에서 위의 encodeURI와 다르다.

# this

## this 키워드
  - 자신이 속한 객체 혹은 자신이 생성할 인스턴스를 가리키는 자기 참조 변수이다.
  - this를 통해 자신이 속한 객체 혹은 생성할 인스턴스의 프로퍼티나 메서드를 참조할 수 있다.
  - 바인딩은 함수 호출 방식에 의해 동적으로 결정된다.

## 함수 호출 방식과 this 바인딩

함수 호출 방식은 다음과 같다.

  - 일반 함수 호출
  - 메서드 호출
  - 생성자 함수 호출
  - Function.prototype.apply/call/bind 메서드에 의한 호출

### 일반 함수 호출
- 기본적으로 this에는 전역 객체가 바인딩 된다.
- 명시적으로 바인딩 하기 위해서는 call/bind/apply 메서드를 사용해야 한다.

### 메서드 호출
- 매서드를 호출할 때, 주체가 되는 객체가 바인딩 된다.
- 메서드 내부의 this는 메서드를 소유한 객체가 아닌 메서드를 호출한 객체에 바인딩 된다.

### 생성자 함수 호출
- 미래에 생성할 인스턴스가 바인딩 된다.

### Function.prototype.apply/call/bind 메서드에 의한 간접 호출
- apply/call/bind 메서드에 첫번째 인수로 전달한 객체가 바인딩 된다.

# 실행 컨텍스트

## 소스코드의 타입
-전역 코드
  - 전역에 존재하는 소스 코드
  - 함수, 클래스 등의 내부 코드는 포함되지 않는다

- 함수 코드
  - 함수 내부에 존재하는 소스 코드
  - 함수 내부에 중첩디ㅗㄴ 함수, 클래스 등의 내부 코드는 포함되지 않는다

- eval 코드
  - 빌트인 전역 함수인 eval 함수에 인수로 전달되어 실행되는 소스코드를 말한다

- 모듈 코드
  - 모듈 내부에 존재하는 소스코드
  - 함수, 클래스 등 내부 코드는 포함되지 않는다

1. 전역코드
  - 전역 변수를 관리하기 위해 최상위 스코프인 전역 스코프를 생성해야 한다.
  - var 키워드로 선언된 전역 변수와 함수 선언문으로 정의된 전역 함수를 전역 객체의 프로퍼티와 메서드로 바인딩 하고 참조하기 위해 전역 객체와 연결되어야 한다.
  - 전역 코드가 평가되면 전역 실행 컨텍스트가 생성

2. 함수 코드
  - 지역 스코프를 생성하고, 지역 변수, 매개변수, arguments 객체를 관리해야 한다.
  - 생성한 지역 스코프를 전역 스코프에서 시작하는 스코프 체인의 일원으로 연결해야 한다.
  - 함수 코드가 평가되면 실행 컨텍스트가 생성된다.

3. eval 코드
  - strict mode에서 자신만의 독자적 스코프 생성한다.
  - 코드가 평가되면 eval 실행 컨텍스트가 생성된다.

4. 모듈코드
  - 독립적인 모듈 스코프를 생성한다.
  - 코드가 평가되면 모듈 실행 컨텍스트가 생성된다.

## 소스 코드의 평가와 실행
모든 소스코드는 실행에 앞서 평가 과정을 거치며, 실행하기 위한 준비를 한다.

- 소스코드의 평가
  - 실행 컨텍스트를 생성하고 변수, 함수 등의 선언문을 우선 실행하여 생성된 변수나 함수 식별자를 키로 실행 컨텍스트가 관리하는 스코프에 등록한다.
  - 평가 과정이 끝나면, 비로소 선언문을 제외한 소스코드가 순차적으로 실행되기 시작한다.
  - 변수나 함수의 참조를 실행 컨텍스트가 관리하는 스코프에서 검색해서 취득한다.
  - 변수 값의 변경 등 소스코드의 실행 결과는 다시 실행 컨텍스트가 관리하는 스코프에 등록된다.

## 실행 컨텍스트의 역할

- 전역 코드 평가
- 전역 코드 실행
- 함수 코드 평가
- 함수 코드 실행

코드가 실행되려면 스코프, 식별자, 코드 실행 순서 등의 관리가 필요하다

1. 선언에 의해 생성된 모든 식별자를 스코프로 구분하여 등록, 상태 변화를 지속적으로 관리할 수 있어야 한다.
2. 스코프는 중첩 관계에 의해 체인을 형성해야 한다.
3. 코드의 실행 순서를 변경할 수 있어야 하며, 되돌아 갈 수 있어야 한다.

## 실행 컨텍스트 스택

1. 전역 코드의 평가와 실행
  - 자바스크립트 엔진은 먼저 전역 코드를 평가하여 전역 실행 컨텍스트를 새엇ㄴ한다.
  - 실행 컨텍스트 스택에 푸시한다.
  - 전역 코드가 실행되기 시작하면 스택에 쌓인 컨텍스트가 차례로 실행된다.

2. foo 함수 코드의 평가와 실행
  - 전역 함수 foo가 호출되면, 전역 코드의 실행이 임시 중단되고 코드의 제어권이 foo 함수 내부로 이동한다.
  - 자바스크립트 엔진은 foo 함수 내부의 코드를 평가하여 foo 함수 실행 컨텍스트를 생성하고 스택에 푸시한다.
  - 이때, foo 함수 내의 지역 변수와 중첩 함수가 실행 컨텍스트에 등록된다.

...

## 렉시컬 환경
식별자와 식별자에 바인딩된 값, 그리고 상위 스코프에 대한 참조를 기록하는 자료구조로 실행 컨텍스트를 구성하는 컴포넌트이다.